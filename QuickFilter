Sub フィルターON
    Dim SeartchWord As String

    On Error GoTo ErrorHandler
    
    SeartchWord = InputBox("検索文字列を入力してください。")
    ActiveSheet.Range("A1").AutoFilter 1, "*" & SeartchWord & "*"

    Exit Sub


    ErrorHandler:
        MsgBox("エラーが発生しました")
End Sub

Sub フィルターOFF
    ActiveSheet.Range("A1").AutoFilter
End Sub

Private Function cellState(state As String) As String
'FilterONプロシージャで呼び出された際はアクティブセルの値を保存'
'FilterOFFプロシージャで呼び出された際は保存したアクティブセルの値を返す'
'VBにstaticなグローバル変数が存在しないため作成したものです'
   
    Static staticCellState As String
   
    If (StrPtr(staticCellState) = 0) Then '一度もセルの状態が保存されていなければ処理を終了'
        Exit Function
    ElseIf state = "get" Then    '引数がgetのとき＝FilterOFFで1回目の呼び出しのとき、保存したセルの状態を返す'
        cellState = staticCellState
    ElseIf state = "clear" Then '引数がclearのとき＝FilterOFFで2回目の呼び出しのとき、変数を初期化'
        staticCellState = vbNullString
    Else                        '上記以外のとき＝FilterONで呼び出されたとき、アクティブセルの値を保存'
        staticCellState = state
    End If
    
End Function